<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×‘×“×™×§×” - ×›×œ 7 ×”××•×œ××•×ª ×‘××¢×¨×›×ª ×”×›×œ×œ×™×</title>
    <style>
        body {
            font-family: 'Heebo', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            direction: rtl;
        }
        .test-section {
            background: rgba(255,255,255,0.15);
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .success { color: #38ef7d; font-weight: bold; }
        .error { color: #f5576c; font-weight: bold; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            color: #333;
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #667eea;
            color: white;
        }
        .check { color: green; }
        .cross { color: red; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ×‘×“×™×§×” - ×›×œ 7 ×”××•×œ××•×ª ×‘××¢×¨×›×ª ×”×›×œ×œ×™×</h1>
    <div id="results"></div>

    <script src="js/commission-rules.js"></script>
    <script src="js/showroom-config.js"></script>
    <script>
        const resultsDiv = document.getElementById('results');
        
        const allShowrooms = [
            { id: 'hyundai-jerusalem', name: '×™×•× ×“××™ ××•×˜×•×œ×™×Ÿ ×™×¨×•×©×œ×™×' },
            { id: 'hyundai-modiin', name: '×™×•× ×“××™ ××•×“×™×¢×™×Ÿ' },
            { id: 'mitsubishi-modiin', name: '××™×¦×•×‘×™×©×™ ××•×“×™×¢×™×Ÿ' },
            { id: 'omoda-modiin', name: '××•××•×“×” ×’\'××§×• ××•×“×™×¢×™×Ÿ' },
            { id: 'kalmobil-modiin', name: '×›×œ××•×‘×™×œ ×˜×¨×™×™×“ ××™×Ÿ ××•×“×™×¢×™×Ÿ' },
            { id: 'geely-modiin', name: '×’\'×™×œ×™ ××•×“×™×¢×™×Ÿ' },
            { id: 'geely-jerusalem', name: '×’\'×™×œ×™ ×™×¨×•×©×œ×™×' }
        ];
        
        let html = '<div class="test-section">';
        html += '<h2>ğŸ“Š ×¡×™×›×•× ×‘×“×™×§×”</h2>';
        html += '<table>';
        html += '<thead><tr><th>#</th><th>××•×œ×</th><th>Config ×§×™×™×?</th><th>Rules ×§×™×™××™×?</th><th>×¡×˜×˜×•×¡</th></tr></thead>';
        html += '<tbody>';
        
        let successCount = 0;
        
        allShowrooms.forEach((showroom, idx) => {
            const config = window.getShowroomConfig(showroom.id);
            const rules = window.getCommissionRules(showroom.id);
            
            const hasConfig = !!config;
            const hasRules = !!rules;
            const success = hasConfig && hasRules;
            
            if (success) successCount++;
            
            html += `<tr>`;
            html += `<td>${idx + 1}</td>`;
            html += `<td><strong>${showroom.name}</strong></td>`;
            html += `<td>${hasConfig ? '<span class="check">âœ… ×›×Ÿ</span>' : '<span class="cross">âŒ ×œ×</span>'}</td>`;
            html += `<td>${hasRules ? '<span class="check">âœ… ×›×Ÿ</span>' : '<span class="cross">âŒ ×œ×</span>'}</td>`;
            html += `<td class="${success ? 'success' : 'error'}">${success ? 'âœ“ ××•×›×Ÿ' : 'âœ— ×—×¡×¨'}</td>`;
            html += `</tr>`;
            
            // More detailed info
            if (success) {
                console.log(`âœ“ ${showroom.name}:`, {
                    config,
                    rules
                });
            }
        });
        
        html += '</tbody></table>';
        html += `<h3>×¡×™×›×•×: ${successCount} ××ª×•×š ${allShowrooms.length} ××•×œ××•×ª ××•×›× ×™×</h3>`;
        html += '</div>';
        
        // Detailed check for specific rules
        html += '<div class="test-section">';
        html += '<h2>ğŸ” ×‘×“×™×§×ª ×›×œ×œ×™× ×¡×¤×¦×™×¤×™×™×</h2>';
        
        // Geely Modiin
        const geelyRules = window.getCommissionRules('geely-modiin');
        html += '<h3>×’\'×™×œ×™ ××•×“×™×¢×™×Ÿ</h3>';
        html += '<ul>';
        html += `<li>×¢××œ×ª ××¡×™×¨×•×ª ×× ×”×œ: <strong>${geelyRules.manager.deliveryRate} ×©"×—</strong></li>`;
        html += `<li>×¢××œ×ª ××¡×™×¨×•×ª × ×¦×™×’: <strong>${geelyRules.salesperson.deliveryRate} ×©"×—</strong></li>`;
        html += `<li>×¡×£ NPS ×× ×”×œ: <strong>${geelyRules.manager.nps.threshold}</strong></li>`;
        html += `<li>××“×¨×’×•×ª ××‘×™×–×¨×™× ×× ×”×œ: <strong>${geelyRules.manager.accessoriesTiers.length} ××“×¨×’×•×ª</strong></li>`;
        html += `<li>××“×¨×’×•×ª ×˜×•×¤ ×¡×¨×•×•×™×¡: <strong>${geelyRules.manager.topService.tiers.length} ××“×¨×’×•×ª</strong></li>`;
        html += `<li>×ª× ××™ ×¡×£ ×—×‘×™×œ×•×ª: <strong>${geelyRules.manager.topService.minPackages}</strong></li>`;
        html += '</ul>';
        
        // Kalmobil
        const kalmobilRules = window.getCommissionRules('kalmobil-modiin');
        html += '<h3>×›×œ××•×‘×™×œ</h3>';
        html += '<ul>';
        html += `<li>××“×¨×’×•×ª ×× ×”×œ (totalCars): <strong>${kalmobilRules.manager.deliveryTiers.length} ××“×¨×’×•×ª</strong></li>`;
        html += `<li>×‘×•× ×•×¡ ××™××•×Ÿ: <strong>${kalmobilRules.manager.financeBonus.bonus} ×©"×—</strong> (××¢×œ ${kalmobilRules.manager.financeBonus.threshold}%)</li>`;
        html += `<li>×‘×•× ×•×¡ ××œ××™: <strong>${kalmobilRules.manager.inventoryBonus.bonus} ×©"×—</strong> (××¢×œ ${kalmobilRules.manager.inventoryBonus.threshold}%)</li>`;
        html += `<li>××“×¨×’×•×ª × ×¦×™×’ (×¨×˜×¨×•): <strong>${kalmobilRules.salesperson.deliveryTiers.length} ××“×¨×’×•×ª</strong></li>`;
        html += '</ul>';
        
        // Hyundai Jerusalem
        const hyundaiJRules = window.getCommissionRules('hyundai-jerusalem');
        html += '<h3>×™×•× ×“××™ ××•×˜×•×œ×™×Ÿ ×™×¨×•×©×œ×™×</h3>';
        html += '<ul>';
        html += `<li>×¢××œ×ª ××¡×™×¨×•×ª ×× ×”×œ: <strong>${hyundaiJRules.manager.deliveryRate} ×©"×—</strong></li>`;
        html += `<li>×¢××œ×ª ××¡×™×¨×•×ª × ×¦×™×’: <strong>${hyundaiJRules.salesperson.deliveryRate} ×©"×—</strong></li>`;
        html += `<li>×˜×•×¤ ×¡×¨×•×•×™×¡ × ×¦×™×’: <strong>${hyundaiJRules.salesperson.topService.rate * 100}%</strong></li>`;
        html += `<li>××“×¨×’×•×ª ×ª×¤×¢×•×œ: <strong>${hyundaiJRules.operations.topServiceTiers.length} ××“×¨×’×•×ª</strong></li>`;
        html += '</ul>';
        
        html += '</div>';
        
        // Summary
        html += '<div class="test-section">';
        html += '<h2>ğŸ“ ×¡×™×›×•×</h2>';
        if (successCount === allShowrooms.length) {
            html += '<p class="success">âœ… ×›×œ 7 ×”××•×œ××•×ª ××•×’×“×¨×™× ×‘××œ×•××!</p>';
            html += '<p>×”××¢×¨×›×ª ××•×›× ×” ×œ×¢×“×›×•× ×™× ×¢×¦×××™×™× ×“×¨×š:</p>';
            html += '<ul>';
            html += '<li><strong>commission-manager.html</strong> - ×××©×§ ×•×™×–×•××œ×™ ×œ×›×œ 7 ×”××•×œ××•×ª</li>';
            html += '<li><strong>js/commission-rules.js</strong> - ×¢×¨×™×›×” ×™×©×™×¨×” ×©×œ ×”×›×œ×œ×™×</li>';
            html += '</ul>';
        } else {
            html += `<p class="error">âš ï¸ ${allShowrooms.length - successCount} ××•×œ××•×ª ×—×¡×¨×™×</p>`;
        }
        html += '</div>';
        
        resultsDiv.innerHTML = html;
        
        console.log('========================================');
        console.log('ğŸ“Š ×‘×“×™×§×ª ×›×œ ×”××•×œ××•×ª ×”×•×©×œ××”');
        console.log('========================================');
        console.log(`âœ“ ××•×›× ×™×: ${successCount}/${allShowrooms.length}`);
        console.log('========================================');
    </script>
</body>
</html>
