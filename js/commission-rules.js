// ========================================
// ğŸ’° ×›×œ×œ×™ ×¢××œ×•×ª - ××§×•×¨ ×××ª ××¨×›×–×™
// ========================================
// 
// ×§×•×‘×¥ ×–×” ××›×™×œ ××ª ×›×œ ×”××“×¨×’×•×ª, ×”×¡×›×•××™× ×•×”×ª× ××™× ×œ×—×™×©×•×‘ ×”×¢××œ×•×ª.
// 
// ğŸ“ ××™×š ×œ×¢×¨×•×š:
// 1. ××¦× ××ª ×”××•×ª×’/××•×œ× ×”×¨×œ×•×•× ×˜×™ ×œ××˜×”
// 2. ×©× ×” ××ª ×”××¡×¤×¨×™× ×‘×©×“×•×ª ×”××ª××™××™×
// 3. ×©××•×¨ ××ª ×”×§×•×‘×¥
// 4. ×¨×¢× ×Ÿ ××ª ×”×“×¤×“×¤×Ÿ (Ctrl+Shift+R / Cmd+Shift+R)
// 
// âš ï¸ ×—×©×•×‘: ××œ ×ª×©× ×” ××ª ×©××•×ª ×”×©×“×•×ª - ×¨×§ ××ª ×”×¢×¨×›×™×!
// ========================================

window.commissionRules = {
    
    // ====================================
    // ğŸš— ×™×•× ×“××™ ××•×˜×•×œ×™×Ÿ ×™×¨×•×©×œ×™×
    // ====================================
    'hyundai-jerusalem': {
        
        // ×× ×”×œ ×¡× ×™×£ - ×××™×¨ ××•×¢×œ×
        manager: {
            deliveryRate: 200,           // ×©"×— ×œ×¨×›×‘
            description: '200 ×©"×— Ã— ×¡×”"×› ××¡×™×¨×•×ª ×”×¡× ×™×£'
        },
        
        // ×× ×©×™ ××›×™×¨×•×ª - ×“× ×™××œ × ×’×¨, ××œ×¤×¨×“ ×‘× ×“
        salesperson: {
            deliveryRate: 100,           // ×©"×— ×œ×¨×›×‘
            
            // ×˜×•×¤ ×¡×¨×•×•×™×¡ - ××—×•×–×™×
            topService: {
                rate: 0.20,              // 20% ××”×ª×’××•×œ
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            // ×‘×™×˜×•×—
            insurance: {
                rate: 80,                // ×©"×— ×œ×¤×•×œ×™×¡×”
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            // ×˜×¨×™×™×“ ××™×Ÿ
            tradein: {
                rate: 120,               // ×©"×— ×œ×¢×¡×§×”
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            // ××™××•×Ÿ
            finance: {
                rate: 100,               // ×©"×— ×œ×¢×¡×§×”
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        },
        
        // ××™×© ×ª×¤×¢×•×œ - ×“× ×™××œ ××œ×™×”
        operations: {
            // ××“×¨×’×•×ª ×œ×¤×™ ××—×•×– ×˜×•×¤ ×¡×¨×•×•×™×¡
            topServiceTiers: [
                { min: 0,  max: 59,  rate: 50,  description: '×¢×“ 59%: 50 ×©"×— ×œ×—×‘×™×œ×”' },
                { min: 60, max: 69,  rate: 70,  description: '60-69%: 70 ×©"×— ×œ×—×‘×™×œ×”' },
                { min: 70, max: 100, rate: 80,  description: '70%+: 80 ×©"×— ×œ×—×‘×™×œ×”' }
            ]
        }
    },
    
    // ====================================
    // ğŸš— ×™×•× ×“××™ ××•×“×™×¢×™×Ÿ
    // ====================================
    'hyundai-modiin': {
        
        // ×× ×”×œ ××•×œ× - ×’×™× ×”×¨×¨×™
        manager: {
            deliveryRate: 200,           // ×©"×— ×œ×¨×›×‘
            description: '200 ×©"×— Ã— ×¡×”"×› ××¡×™×¨×•×ª ×”×¡× ×™×£'
        },
        
        // ×× ×©×™ ××›×™×¨×•×ª - ×“×¨×™×• × ×•×˜×¨×™×§×”, ××™×© ××›×™×¨×•×ª 2
        salesperson: {
            deliveryRate: 100,           // ×©"×— ×œ×¨×›×‘
            
            topService: {
                rate: 0.20,              // 20%
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            insurance: {
                rate: 80,                // ×©"×— ×œ×¤×•×œ×™×¡×”
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            tradein: {
                rate: 120,               // ×©"×— ×œ×¢×¡×§×”
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            finance: {
                rate: 100,               // ×©"×— ×œ×¢×¡×§×”
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        },
        
        // ××™×© ×ª×¤×¢×•×œ - ××©×¨ ×¢××¨
        operations: {
            topServiceTiers: [
                { min: 0,  max: 59,  rate: 50,  description: '×¢×“ 59%: 50 ×©"×— ×œ×—×‘×™×œ×”' },
                { min: 60, max: 69,  rate: 70,  description: '60-69%: 70 ×©"×— ×œ×—×‘×™×œ×”' },
                { min: 70, max: 100, rate: 80,  description: '70%+: 80 ×©"×— ×œ×—×‘×™×œ×”' }
            ]
        }
    },
    
    // ====================================
    // ğŸš— ××™×¦×•×‘×™×©×™ ××•×“×™×¢×™×Ÿ
    // ====================================
    'mitsubishi-modiin': {
        
        // ×× ×”×œ ××•×œ× ××•×›×¨ - ×©×—×£ ×›×”×Ÿ
        sellingManager: {
            deliveryRate: 100,           // ×©"×— ×œ×¨×›×‘ (×›××• × ×¦×™×’)
            
            topService: {
                rate: 0.20,
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            insurance: {
                rate: 80,
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            tradein: {
                rate: 120,
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            finance: {
                rate: 100,
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        },
        
        // ××™×© ××›×™×¨×•×ª 1
        salesperson: {
            deliveryRate: 100,
            
            topService: {
                rate: 0.20,
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            insurance: {
                rate: 80,
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            tradein: {
                rate: 120,
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            finance: {
                rate: 100,
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        }
    },
    
    // ====================================
    // ğŸš— ××•××•×“×” ×’'××§×• ××•×“×™×¢×™×Ÿ
    // ====================================
    'omoda-modiin': {
        
        // ×× ×”×œ×ª ××•×œ× ××•×›×¨×ª - ×”×™×œ×” ×©×œ×•××™
        sellingManager: {
            deliveryRate: 100,
            
            topService: {
                rate: 0.20,
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            insurance: {
                rate: 80,
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            tradein: {
                rate: 120,
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            finance: {
                rate: 100,
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        },
        
        // ×× ×©×™ ××›×™×¨×•×ª - ×©×™×¨ ×¢×œ×™××”, ×™×”×‘ ×‘×Ÿ ×“×•×“
        salesperson: {
            deliveryRate: 100,
            
            topService: {
                rate: 0.20,
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            insurance: {
                rate: 80,
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            tradein: {
                rate: 120,
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            finance: {
                rate: 100,
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        },
        
        // ××™×© ×ª×¤×¢×•×œ - ××©×¨ ×¢××¨
        operations: {
            topServiceTiers: [
                { min: 0,  max: 59,  rate: 50,  description: '×¢×“ 59%: 50 ×©"×— ×œ×—×‘×™×œ×”' },
                { min: 60, max: 69,  rate: 70,  description: '60-69%: 70 ×©"×— ×œ×—×‘×™×œ×”' },
                { min: 70, max: 100, rate: 80,  description: '70%+: 80 ×©"×— ×œ×—×‘×™×œ×”' }
            ]
        }
    },
    
    // ====================================
    // ğŸš— ×’'×™×œ×™ ××•×“×™×¢×™×Ÿ ×•×™×¨×•×©×œ×™×
    // ====================================
    'geely-modiin': {
        
        // ×× ×”×œ ××•×œ× - ××•×¨×™ ×¢×¡×™×¡
        manager: {
            // ××¡×™×¨×•×ª
            deliveryRate: 200,           // ×©"×— ×œ×¨×›×‘
            
            // ×§×™×–×•×– NPS
            nps: {
                threshold: 75,           // ×¡×£ ××™× ×™××•×
                penaltyPercent: 0.10,    // 10% ×§×™×–×•×– ×× ××ª×—×ª ×œ×¡×£
                description: '×§×™×–×•×– 10% ×× NPS ××ª×—×ª ×œ-75'
            },
            
            // ××‘×™×–×¨×™× - ××“×¨×’×•×ª ×œ×¤×™ ×××•×¦×¢
            accessoriesTiers: [
                { min: 0,    max: 1500,  rate: 0.02, description: '×¢×“ 1500: 2%' },
                { min: 1501, max: 2200,  rate: 0.03, description: '1501-2200: 3%' },
                { min: 2201, max: 3000,  rate: 0.04, description: '2201-3000: 4%' },
                { min: 3001, max: 99999, rate: 0.05, description: '3001+: 5%' }
            ],
            
            // ×˜×¨×™×™×“ ××™×Ÿ - ××“×¨×’×•×ª ×œ×¤×™ ××—×•×–
            tradeinTiers: [
                { min: 0,    max: 15.0,  rate: 120, description: '×¢×“ 15%: 120 ×©"×—' },
                { min: 15.1, max: 19.9,  rate: 150, description: '15.1-19.9%: 150 ×©"×—' },
                { min: 20.0, max: 100,   rate: 250, description: '20%+: 250 ×©"×—' }
            ],
            
            // ××™××•×Ÿ ×‘×”×¡×“×¨
            finance: {
                threshold: 25,           // % ××™× ×™××•×
                bonus: 500,              // ×©"×— ×‘×•× ×•×¡
                description: '+500 ×©"×— ×× ××¢×œ 25%'
            },
            
            // ×‘×™×˜×•×— - ××“×¨×’×•×ª ×œ×¤×™ ××—×•×–
            insuranceTiers: [
                { min: 0,  max: 39.9, amount: 0,    description: '×¢×“ 40%: 0' },
                { min: 40, max: 44.9, amount: 500,  description: '40-44.9%: 500 ×©"×—' },
                { min: 45, max: 49.9, amount: 750,  description: '45-49.9%: 750 ×©"×—' },
                { min: 50, max: 100,  amount: 1000, description: '50%+: 1000 ×©"×—' }
            ],
            
            // ×˜×•×¤ ×¡×¨×•×•×™×¡ (×—×‘×™×œ×•×ª ×©×™×¨×•×ª)
            topService: {
                minPackages: 5,          // ×ª× ××™ ×¡×£ - ××™× ×™××•× ×—×‘×™×œ×•×ª
                tiers: [
                    { min: 0,  max: 59.9, amount: 0,    description: '××ª×—×ª ×œ-60%: 0' },
                    { min: 60, max: 69.9, amount: 500,  description: '60-69.9%: 500 ×©"×—' },
                    { min: 70, max: 79.9, amount: 750,  description: '70-79.9%: 750 ×©"×—' },
                    { min: 80, max: 100,  amount: 1250, description: '80%+: 1250 ×©"×—' }
                ],
                description: '×ª× ××™ ×¡×£: ××™× ×™××•× 5 ×—×‘×™×œ×•×ª'
            }
        },
        
        // × ×¦×™×’×™ ××›×™×¨×•×ª - ×“× ×™××œ ×¢×˜×™×”, ××©×™ ×’×¨××”
        salesperson: {
            // ××¡×™×¨×•×ª
            deliveryRate: 100,           // ×©"×— ×œ×¨×›×‘
            
            // NPS
            nps: {
                penaltyThreshold: 75,    // ×§×™×–×•×– ××ª×—×ª ×œ×–×”
                penaltyPercent: 0.10,    // 10% ×§×™×–×•×–
                bonusThreshold: 84,      // ×‘×•× ×•×¡ ××¢×œ ×–×”
                bonusPerDelivery: 20,    // ×©"×— ×œ×›×œ ××¡×™×¨×”
                bonusPerMeeting: 20,     // ×©"×— ×œ×›×œ ×¤×’×™×©×ª ××¡×™×¨×”
                description: '×§×™×–×•×– 10% ×× <75, ×‘×•× ×•×¡ ×× >84'
            },
            
            // ××‘×™×–×¨×™× - ××“×¨×’×•×ª ×œ×¤×™ ×××•×¦×¢
            accessoriesTiers: [
                { min: 0,    max: 1199,  rate: 0.00, description: '×¢×“ 1200: 0%' },
                { min: 1200, max: 1500,  rate: 0.03, description: '1200-1500: 3%' },
                { min: 1501, max: 2500,  rate: 0.06, description: '1501-2500: 6%' },
                { min: 2501, max: 99999, rate: 0.07, description: '2501+: 7%' }
            ],
            
            // ××—×¨×™×•×ª
            warranty: {
                rate: 40,                // ×©"×— ×œ×—×‘×™×œ×”
                description: '40 ×©"×— ×œ×—×‘×™×œ×ª ××—×¨×™×•×ª'
            },
            
            // ×‘×™×˜×•×— - ××“×¨×’×•×ª ×œ×¤×™ ××—×•×–
            insuranceTiers: [
                { min: 0,    max: 25.9, rate: 35, description: '×¢×“ 25%: 35 ×©"×—' },
                { min: 26,   max: 40,   rate: 60, description: '26-40%: 60 ×©"×—' },
                { min: 40.1, max: 100,  rate: 80, description: '41%+: 80 ×©"×—' }
            ],
            
            // ×˜×¨×™×™×“ ××™×Ÿ
            tradein: {
                rate: 120,               // ×©"×— ×œ×¢×¡×§×”
                description: '120 ×©"×— ×œ×¢×¡×§×ª ×˜×¨×™×™×“ ××™×Ÿ'
            },
            
            // ×—×‘×™×œ×•×ª ×©×™×¨×•×ª
            service: {
                rate: 80,                // ×©"×— ×œ×—×‘×™×œ×”
                description: '80 ×©"×— ×œ×—×‘×™×œ×ª ×©×™×¨×•×ª'
            }
        }
    },
    
    // ×’'×™×œ×™ ×™×¨×•×©×œ×™× - ××•×ª× ×›×œ×œ×™× ×‘×“×™×•×§
    'geely-jerusalem': {
        // ×”×¢×ª×§ ××“×•×™×§ ×©×œ geely-modiin
        // (× ×©×ª××© ×‘××•×ª× ×›×œ×œ×™×)
    },
    
    // ====================================
    // ğŸš— ×›×œ××•×‘×™×œ ×˜×¨×™×™×“ ××™×Ÿ ××•×“×™×¢×™×Ÿ
    // ====================================
    'kalmobil-modiin': {
        
        // ×× ×”×œ ××•×œ× - ×“×•×“ ×¢×–×¨×
        manager: {
            // ××“×¨×’×•×ª ×œ×¤×™ totalCars
            deliveryTiers: [
                { min: 0,  max: 49,  rate: 4000, description: '×¢×“ 49: 4,000 ×©"×—' },
                { min: 50, max: 69,  rate: 5000, description: '50-69: 5,000 ×©"×—' },
                { min: 70, max: 89,  rate: 7000, description: '70-89: 7,000 ×©"×—' },
                { min: 90, max: 109, rate: 8000, description: '90-109: 8,000 ×©"×—' },
                { min: 110, max: 999, rate: 10000, description: '110+: 10,000 ×©"×—' }
            ],
            
            // ×‘×•× ×•×¡×™×
            financeBonus: {
                threshold: 32,        // % ××™× ×™××•×
                bonus: 1000,          // ×©"×—
                description: '×™×¢×“ ××¡×™×¨×•×ª + 32% ××™××•×Ÿ = â‚ª1,000'
            },
            
            inventoryBonus: {
                threshold: 40,        // % ××›×™×¨×” ××”××œ××™
                bonus: 1000,          // ×©"×—
                description: '×™×¢×“ ××œ××™: 40%+ ××›×™×¨×•×ª ××”××œ××™ = â‚ª1,000'
            }
        },
        
        // ××™×© ××›×™×¨×•×ª - ××‘×™×¢×“ ×œ×•×œ××™
        salesperson: {
            // ××“×¨×’×•×ª ×¢× ×¨×˜×¨×•
            deliveryTiers: [
                { min: 0,  max: 9,  rate: 200, description: '×¢×“ 9: 200 ×©"×— ×œ×¨×›×‘' },
                { min: 10, max: 14, rate: 300, description: '10-14: 300 ×©"×— ×œ×¨×›×‘ (×¨×˜×¨×•)' },
                { min: 15, max: 19, rate: 350, description: '15-19: 350 ×©"×— ×œ×¨×›×‘ (×¨×˜×¨×•)' },
                { min: 20, max: 24, rate: 400, description: '20-24: 400 ×©"×— ×œ×¨×›×‘ (×¨×˜×¨×•)' },
                { min: 25, max: 999, rate: 450, description: '25+: 450 ×©"×— ×œ×¨×›×‘ (×¨×˜×¨×•)' }
            ],
            
            topService: {
                rate: 0.20,
                description: '20% ××ª×’××•×œ ×”×˜×•×¤ ×¡×¨×•×•×™×¡'
            },
            
            insurance: {
                rate: 80,
                description: '80 ×©"×— ×œ×¤×•×œ×™×¡×”'
            },
            
            tradein: {
                rate: 120,
                description: '120 ×©"×— ×œ×¢×¡×§×”'
            },
            
            finance: {
                rate: 100,
                description: '100 ×©"×— ×œ×¢×¡×§×ª ××™××•×Ÿ'
            }
        },
        
        // ××™×© ×ª×¤×¢×•×œ - ×“×•×“ ×”×™×¨×©×”×•×¨×Ÿ
        operations: {
            // ×¢××œ×•×ª ×”×–× ×” ×™×“× ×™×ª
            description: '×¢××œ×•×ª × ×§×‘×¢×•×ª ×™×“× ×™×ª ×œ×¤×™ ×‘×™×¦×•×¢×™×'
        }
    }
};

// ×”×¢×ª×§×ª ×›×œ×œ×™ ×’'×™×œ×™ ×™×¨×•×©×œ×™× ××’'×™×œ×™ ××•×“×™×¢×™×Ÿ
window.commissionRules['geely-jerusalem'] = JSON.parse(JSON.stringify(window.commissionRules['geely-modiin']));

// ========================================
// ğŸ”§ ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×œ×§×‘×œ×ª ×›×œ×œ×™×
// ========================================

// ×§×‘×œ×ª ×›×œ×œ×™ ×¢××œ×•×ª ×œ××•×œ× ×¡×¤×¦×™×¤×™
window.getCommissionRules = function(showroomId) {
    return window.commissionRules[showroomId] || null;
};

// ×§×‘×œ×ª ×›×œ×œ×™ ×¢××œ×•×ª ×œ×¡×•×’ ×¢×•×‘×“ ×¡×¤×¦×™×¤×™
window.getEmployeeCommissionRules = function(showroomId, employeeType) {
    const rules = window.commissionRules[showroomId];
    if (!rules) return null;
    
    return rules[employeeType] || null;
};

// ×œ×•×’ ×©×œ ×›×œ ×”×›×œ×œ×™× (×œ×‘×“×™×§×”)
console.log('âœ“ Commission rules loaded:', Object.keys(window.commissionRules).length, 'showrooms');
